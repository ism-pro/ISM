
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){a(require("jquery"))}else{a(jQuery)}}})(function(E){var M=E(window),v=E(document),p=window.location,h=".cropper",Q="preview"+h,j=/^(e|n|w|s|ne|nw|sw|se|all|crop|move|zoom)$/,S="cropper-modal",D="cropper-hide",I="cropper-hidden",K="cropper-invisible",e="cropper-move",J="cropper-crop",H="cropper-disabled",a="cropper-bg",o="mousedown touchstart",t="mousemove touchmove",N="mouseup mouseleave touchend touchleave touchcancel",g="wheel mousewheel DOMMouseScroll",i="dblclick",b="resize"+h,C="build"+h,s="built"+h,B="dragstart"+h,z="dragmove"+h,m="dragend"+h,A="zoomin"+h,R="zoomout"+h,c=E.isFunction(E("<canvas>")[0].getContext),G=Math.sqrt,T=Math.min,w=Math.max,y=Math.abs,n=Math.sin,f=Math.cos,O=parseFloat,r={};function U(V){return typeof V==="number"&&!isNaN(V)}function q(V){return typeof V==="undefined"}function u(W,X){var V=[];if(U(X)){V.push(X)}return V.slice.apply(W,V)}function L(X,W){var V=u(arguments,2);return function(){return X.apply(W,V.concat(u(arguments)))}}function P(V){var W=V.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return W&&(W[1]!==p.protocol||W[2]!==p.hostname||W[3]!==p.port)}function l(V){var W="timestamp="+(new Date()).getTime();return(V+(V.indexOf("?")===-1?"?":"&")+W)}function k(V){return V?"rotate("+V+"deg)":"none"}function d(aa,ab){var W=y(aa.degree)%180,Y=(W>90?(180-W):W)*Math.PI/180,ac=n(Y),ae=f(Y),X=aa.width,af=aa.height,ad=aa.aspectRatio,Z,V;if(!ab){Z=X*ae+af*ac;V=X*ac+af*ae}else{Z=X/(ae+ac/ad);V=Z/ad}return{width:Z,height:V}}function F(ac,ab){var Y=E("<canvas>")[0],Z=Y.getContext("2d"),aa=ab.naturalWidth,V=ab.naturalHeight,X=ab.rotate,W=d({width:aa,height:V,degree:X});if(X){Y.width=W.width;Y.height=W.height;Z.save();Z.translate(W.width/2,W.height/2);Z.rotate(X*Math.PI/180);Z.drawImage(ac,-aa/2,-V/2,aa,V);Z.restore()}else{Y.width=aa;Y.height=V;Z.drawImage(ac,0,0,aa,V)}return Y}function x(W,V){this.$element=E(W);this.options=E.extend({},x.DEFAULTS,E.isPlainObject(V)&&V);this.ready=false;this.built=false;this.rotated=false;this.cropped=false;this.disabled=false;this.canvas=null;this.cropBox=null;this.load()}r.load=function(Z){var Y=this.options,ab=this.$element,V,X,W,aa;if(!Z){if(ab.is("img")){if(!ab.attr("src")){return}Z=ab.prop("src")}else{if(ab.is("canvas")&&c){Z=ab[0].toDataURL()}}}if(!Z){return}W=E.Event(C);ab.one(C,Y.build).trigger(W);if(W.isDefaultPrevented()){return}if(Y.checkImageOrigin&&P(Z)){V="anonymous";if(!ab.prop("crossOrigin")){X=l(Z)}}this.$clone=aa=E("<img>");aa.one("load",E.proxy(function(){var ac=aa.prop("naturalWidth")||aa.width(),ad=aa.prop("naturalHeight")||aa.height();this.image={naturalWidth:ac,naturalHeight:ad,aspectRatio:ac/ad,rotate:0};this.url=Z;this.ready=true;this.build()},this)).one("error",function(){aa.remove()}).attr({crossOrigin:V,src:X||Z});aa.addClass(D).insertAfter(ab)};r.build=function(){var Z=this.$element,Y=this.$clone,X=this.options,W,V;if(!this.ready){return}if(this.built){this.unbuild()}this.$cropper=W=E(x.TEMPLATE);Z.addClass(I);Y.removeClass(D);this.$container=Z.parent().append(W);this.$canvas=W.find(".cropper-canvas").append(Y);this.$dragBox=W.find(".cropper-drag-box");this.$cropBox=V=W.find(".cropper-crop-box");this.$viewBox=W.find(".cropper-view-box");this.addListeners();this.initPreview();X.aspectRatio=O(X.aspectRatio)||NaN;if(X.autoCrop){this.cropped=true;if(X.modal){this.$dragBox.addClass(S)}}else{V.addClass(I)}if(X.background){W.addClass(a)}if(!X.highlight){V.find(".cropper-face").addClass(K)}if(!X.guides){V.find(".cropper-dashed").addClass(I)}if(!X.movable){V.find(".cropper-face").data("drag","move")}if(!X.resizable){V.find(".cropper-line, .cropper-point").addClass(I)}this.setDragMode(X.dragCrop?"crop":"move");this.built=true;this.render();this.setData(X.data);Z.one(s,X.built).trigger(s)};r.unbuild=function(){if(!this.built){return}this.built=false;this.initialImage=null;this.initialCanvas=null;this.initialCropBox=null;this.container=null;this.canvas=null;this.cropBox=null;this.removeListeners();this.resetPreview();this.$preview=null;this.$viewBox=null;this.$cropBox=null;this.$dragBox=null;this.$canvas=null;this.$container=null;this.$cropper.remove();this.$cropper=null};E.extend(r,{render:function(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();if(this.cropped){this.renderCropBox()}},initContainer:function(){var X=this.$element,Y=this.$container,V=this.$cropper,W=this.options;V.addClass(I);X.removeClass(I);V.css((this.container={width:w(Y.width(),O(W.minContainerWidth)||200),height:w(Y.height(),O(W.minContainerHeight)||100)}));X.addClass(I);V.removeClass(I)},initCanvas:function(){var V=this.container,Z=V.width,Y=V.height,aa=this.image,X=aa.aspectRatio,W={aspectRatio:X,width:Z,height:Y};if(Y*X>Z){W.height=Z/X}else{W.width=Y*X}W.oldLeft=W.left=(Z-W.width)/2;W.oldTop=W.top=(Y-W.height)/2;this.canvas=W;this.limitCanvas(true,true);this.initialImage=E.extend({},aa);this.initialCanvas=E.extend({},W)},limitCanvas:function(aj,Z){var ak=this.options,ae=ak.strict,V=this.container,ad=V.width,ai=V.height,W=this.canvas,ag=W.aspectRatio,Y=this.cropBox,ac=this.cropped&&Y,af=this.initialCanvas||W,X=af.width,ab=af.height,ah,aa;if(aj){ah=O(ak.minCanvasWidth)||0;aa=O(ak.minCanvasHeight)||0;if(ah){if(ae){ah=w(ac?Y.width:X,ah)}aa=ah/ag}else{if(aa){if(ae){aa=w(ac?Y.height:ab,aa)}ah=aa*ag}else{if(ae){if(ac){ah=Y.width;aa=Y.height;if(aa*ag>ah){ah=aa*ag}else{aa=ah/ag}}else{ah=X;aa=ab}}}}E.extend(W,{minWidth:ah,minHeight:aa,maxWidth:Infinity,maxHeight:Infinity})}if(Z){if(ae){if(ac){W.minLeft=T(Y.left,(Y.left+Y.width)-W.width);W.minTop=T(Y.top,(Y.top+Y.height)-W.height);W.maxLeft=Y.left;W.maxTop=Y.top}else{W.minLeft=T(0,ad-W.width);W.minTop=T(0,ai-W.height);W.maxLeft=w(0,ad-W.width);W.maxTop=w(0,ai-W.height)}}else{W.minLeft=-W.width;W.minTop=-W.height;W.maxLeft=ad;W.maxTop=ai}}},renderCanvas:function(aa){var X=this.options,W=this.canvas,Z=this.image,Y,V;if(this.rotated){this.rotated=false;V=d({width:Z.width,height:Z.height,degree:Z.rotate});Y=V.width/V.height;if(Y!==W.aspectRatio){W.left-=(V.width-W.width)/2;W.top-=(V.height-W.height)/2;W.width=V.width;W.height=V.height;W.aspectRatio=Y;this.limitCanvas(true,false)}}if(W.width>W.maxWidth||W.width<W.minWidth){W.left=W.oldLeft}if(W.height>W.maxHeight||W.height<W.minHeight){W.top=W.oldTop}W.width=T(w(W.width,W.minWidth),W.maxWidth);W.height=T(w(W.height,W.minHeight),W.maxHeight);this.limitCanvas(false,true);W.oldLeft=W.left=T(w(W.left,W.minLeft),W.maxLeft);W.oldTop=W.top=T(w(W.top,W.minTop),W.maxTop);this.$canvas.css({width:W.width,height:W.height,left:W.left,top:W.top});this.renderImage();if(this.cropped&&X.strict){this.limitCropBox(true,true)}if(aa){this.output()}},renderImage:function(){var V=this.canvas,W=this.image,X;if(W.rotate){X=d({width:V.width,height:V.height,degree:W.rotate,aspectRatio:W.aspectRatio},true)}E.extend(W,X?{width:X.width,height:X.height,left:(V.width-X.width)/2,top:(V.height-X.height)/2}:{width:V.width,height:V.height,left:0,top:0});this.$clone.css({width:W.width,height:W.height,marginLeft:W.left,marginTop:W.top,transform:k(W.rotate)})},initCropBox:function(){var W=this.options,V=this.canvas,Y=W.aspectRatio,Z=O(W.autoCropArea)||0.8,X={width:V.width,height:V.height};if(Y){if(V.height*Y>V.width){X.height=X.width/Y}else{X.width=X.height*Y}}this.cropBox=X;this.limitCropBox(true,true);X.width=T(w(X.width,X.minWidth),X.maxWidth);X.height=T(w(X.height,X.minHeight),X.maxHeight);X.width=w(X.minWidth,X.width*Z);X.height=w(X.minHeight,X.height*Z);X.oldLeft=X.left=V.left+(V.width-X.width)/2;X.oldTop=X.top=V.top+(V.height-X.height)/2;this.initialCropBox=E.extend({},X)},limitCropBox:function(af,Z){var ag=this.options,ac=ag.strict,W=this.container,ab=W.width,ae=W.height,X=this.canvas,Y=this.cropBox,ad=ag.aspectRatio,V,aa;if(af){V=O(ag.minCropBoxWidth)||0;aa=O(ag.minCropBoxHeight)||0;Y.minWidth=T(ab,V);Y.minHeight=T(ae,aa);Y.maxWidth=T(ab,ac?X.width:ab);Y.maxHeight=T(ae,ac?X.height:ae);if(ad){if(Y.maxHeight*ad>Y.maxWidth){Y.minHeight=Y.minWidth/ad;Y.maxHeight=Y.maxWidth/ad}else{Y.minWidth=Y.minHeight*ad;Y.maxWidth=Y.maxHeight*ad}}Y.minWidth=T(Y.maxWidth,Y.minWidth);Y.minHeight=T(Y.maxHeight,Y.minHeight)}if(Z){if(ac){Y.minLeft=w(0,X.left);Y.minTop=w(0,X.top);Y.maxLeft=T(ab,X.left+X.width)-Y.width;Y.maxTop=T(ae,X.top+X.height)-Y.height}else{Y.minLeft=0;Y.minTop=0;Y.maxLeft=ab-Y.width;Y.maxTop=ae-Y.height}}},renderCropBox:function(){var X=this.options,V=this.container,aa=V.width,Z=V.height,W=this.$cropBox,Y=this.cropBox;if(Y.width>Y.maxWidth||Y.width<Y.minWidth){Y.left=Y.oldLeft}if(Y.height>Y.maxHeight||Y.height<Y.minHeight){Y.top=Y.oldTop}Y.width=T(w(Y.width,Y.minWidth),Y.maxWidth);Y.height=T(w(Y.height,Y.minHeight),Y.maxHeight);this.limitCropBox(false,true);Y.oldLeft=Y.left=T(w(Y.left,Y.minLeft),Y.maxLeft);Y.oldTop=Y.top=T(w(Y.top,Y.minTop),Y.maxTop);if(X.movable){W.find(".cropper-face").data("drag",(Y.width===aa&&Y.height===Z)?"move":"all")}W.css({width:Y.width,height:Y.height,left:Y.left,top:Y.top});if(this.cropped&&X.strict){this.limitCanvas(true,true)}if(!this.disabled){this.output()}},output:function(){var V=this.options;this.preview();if(V.crop){V.crop.call(this.$element,this.getData())}}});r.initPreview=function(){var V=this.url;this.$preview=E(this.options.preview);this.$viewBox.html('<img src="'+V+'">');this.$preview.each(function(){var W=E(this);W.data(Q,{width:W.width(),height:W.height(),original:W.html()}).html('<img src="'+V+'" style="display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation: 0deg!important">')})};r.resetPreview=function(){this.$preview.each(function(){var V=E(this);V.html(V.data(Q).original).removeData(Q)})};r.preview=function(){var ac=this.image,X=this.canvas,Z=this.cropBox,Y=ac.width,V=ac.height,ab=Z.left-X.left-ac.left,aa=Z.top-X.top-ac.top,W=ac.rotate;if(!this.cropped||this.disabled){return}this.$viewBox.find("img").css({width:Y,height:V,marginLeft:-ab,marginTop:-aa,transform:k(W)});this.$preview.each(function(){var ah=E(this),ag=ah.data(Q),ae=ag.width/Z.width,af=ag.width,ad=Z.height*ae;if(ad>ag.height){ae=ag.height/Z.height;af=Z.width*ae;ad=ag.height}ah.width(af).height(ad).find("img").css({width:Y*ae,height:V*ae,marginLeft:-ab*ae,marginTop:-aa*ae,transform:k(W)})})};r.addListeners=function(){var V=this.options;this.$element.on(B,V.dragstart).on(z,V.dragmove).on(m,V.dragend).on(A,V.zoomin).on(R,V.zoomout);this.$cropper.on(o,E.proxy(this.dragstart,this)).on(i,E.proxy(this.dblclick,this));if(V.zoomable&&V.mouseWheelZoom){this.$cropper.on(g,E.proxy(this.wheel,this))}v.on(t,(this._dragmove=L(this.dragmove,this))).on(N,(this._dragend=L(this.dragend,this)));if(V.responsive){M.on(b,(this._resize=L(this.resize,this)))}};r.removeListeners=function(){var V=this.options;this.$element.off(B,V.dragstart).off(z,V.dragmove).off(m,V.dragend).off(A,V.zoomin).off(R,V.zoomout);this.$cropper.off(o,this.dragstart).off(i,this.dblclick);if(V.zoomable&&V.mouseWheelZoom){this.$cropper.off(g,this.wheel)}v.off(t,this._dragmove).off(N,this._dragend);if(V.responsive){M.off(b,this._resize)}};E.extend(r,{resize:function(){var Z=this.$container,V=this.container,W,Y,X;if(this.disabled){return}X=Z.width()/V.width;if(X!==1||Z.height()!==V.height){W=this.getCanvasData();Y=this.getCropBoxData();this.render();this.setCanvasData(E.each(W,function(aa,ab){W[aa]=ab*X}));this.setCropBoxData(E.each(Y,function(aa,ab){Y[aa]=ab*X}))}},dblclick:function(){if(this.disabled){return}if(this.$dragBox.hasClass(J)){this.setDragMode("move")}else{this.setDragMode("crop")}},wheel:function(V){var W=V.originalEvent,X=1;if(this.disabled){return}V.preventDefault();if(W.deltaY){X=W.deltaY>0?1:-1}else{if(W.wheelDelta){X=-W.wheelDelta/120}else{if(W.detail){X=W.detail>0?1:-1}}}this.zoom(-X*0.1)},dragstart:function(aa){var X=this.options,V=aa.originalEvent,ac=V&&V.touches,ab=aa,Z,Y,W;if(this.disabled){return}if(ac){W=ac.length;if(W>1){if(X.zoomable&&X.touchDragZoom&&W===2){ab=ac[1];this.startX2=ab.pageX;this.startY2=ab.pageY;Z="zoom"}else{return}}ab=ac[0]}Z=Z||E(ab.target).data("drag");if(j.test(Z)){aa.preventDefault();Y=E.Event(B,{originalEvent:V,dragType:Z});this.$element.trigger(Y);if(Y.isDefaultPrevented()){return}this.dragType=Z;this.cropping=false;this.startX=ab.pageX;this.startY=ab.pageY;if(Z==="crop"){this.cropping=true;this.$dragBox.addClass(S)}}},dragmove:function(Z){var X=this.options,V=Z.originalEvent,ac=V&&V.touches,ab=Z,Y=this.dragType,aa,W;if(this.disabled){return}if(ac){W=ac.length;if(W>1){if(X.zoomable&&X.touchDragZoom&&W===2){ab=ac[1];this.endX2=ab.pageX;this.endY2=ab.pageY}else{return}}ab=ac[0]}if(Y){Z.preventDefault();aa=E.Event(z,{originalEvent:V,dragType:Y});this.$element.trigger(aa);if(aa.isDefaultPrevented()){return}this.endX=ab.pageX;this.endY=ab.pageY;this.change()}},dragend:function(W){var V=this.dragType,X;if(this.disabled){return}if(V){W.preventDefault();X=E.Event(m,{originalEvent:W.originalEvent,dragType:V});this.$element.trigger(X);if(X.isDefaultPrevented()){return}if(this.cropping){this.cropping=false;this.$dragBox.toggleClass(S,this.cropped&&this.options.modal)}this.dragType=""}}});E.extend(r,{crop:function(){if(!this.built||this.disabled){return}if(!this.cropped){this.cropped=true;this.limitCropBox(true,true);if(this.options.modal){this.$dragBox.addClass(S)}this.$cropBox.removeClass(I)}this.setCropBoxData(this.initialCropBox)},reset:function(){if(!this.built||this.disabled){return}this.image=E.extend({},this.initialImage);this.canvas=E.extend({},this.initialCanvas);this.cropBox=E.extend({},this.initialCropBox);this.renderCanvas();if(this.cropped){this.renderCropBox()}},clear:function(){if(!this.cropped||this.disabled){return}E.extend(this.cropBox,{left:0,top:0,width:0,height:0});this.cropped=false;this.renderCropBox();this.limitCanvas();this.renderCanvas();this.$dragBox.removeClass(S);this.$cropBox.addClass(I)},destroy:function(){var V=this.$element;if(this.ready){this.unbuild();V.removeClass(I)}else{if(this.$clone){this.$clone.remove()}}V.removeData("cropper")},replace:function(V){if(!this.disabled&&V){this.load(V)}},enable:function(){if(this.built){this.disabled=false;this.$cropper.removeClass(H)}},disable:function(){if(this.built){this.disabled=true;this.$cropper.addClass(H)}},move:function(V,X){var W=this.canvas;if(this.built&&!this.disabled&&U(V)&&U(X)){W.left+=V;W.top+=X;this.renderCanvas(true)}},zoom:function(Z){var W=this.canvas,Y,X,V;Z=O(Z);if(Z&&this.built&&!this.disabled&&this.options.zoomable){Y=Z>0?E.Event(A):E.Event(R);this.$element.trigger(Y);if(Y.isDefaultPrevented()){return}Z=Z<=-1?1/(1-Z):Z<=1?(1+Z):Z;X=W.width*Z;V=W.height*Z;W.left-=(X-W.width)/2;W.top-=(V-W.height)/2;W.width=X;W.height=V;this.renderCanvas(true);this.setDragMode("move")}},rotate:function(W){var V=this.image;W=O(W);if(W&&this.built&&!this.disabled&&this.options.rotatable){V.rotate=(V.rotate+W)%360;this.rotated=true;this.renderCanvas(true)}},getData:function(){var X=this.cropBox,V=this.canvas,Z=this.image,W,Y;if(this.built&&this.cropped){Y={x:X.left-V.left,y:X.top-V.top,width:X.width,height:X.height};W=Z.width/Z.naturalWidth;E.each(Y,function(aa,ab){ab=ab/W;Y[aa]=ab})}else{Y={x:0,y:0,width:0,height:0}}Y.rotate=this.ready?Z.rotate:0;return Y},setData:function(Y){var Z=this.image,V=this.canvas,X={},W;if(this.built&&!this.disabled&&E.isPlainObject(Y)){if(U(Y.rotate)&&Y.rotate!==Z.rotate&&this.options.rotatable){Z.rotate=Y.rotate;this.rotated=true;this.renderCanvas(true)}W=Z.width/Z.naturalWidth;if(U(Y.x)){X.left=Y.x*W+V.left}if(U(Y.y)){X.top=Y.y*W+V.top}if(U(Y.width)){X.width=Y.width*W}if(U(Y.height)){X.height=Y.height*W}this.setCropBoxData(X)}},getContainerData:function(){return this.built?this.container:{}},getImageData:function(){return this.ready?this.image:{}},getCanvasData:function(){var V=this.canvas,W;if(this.built){W={left:V.left,top:V.top,width:V.width,height:V.height}}return W||{}},setCanvasData:function(X){var V=this.canvas,W=V.aspectRatio;if(this.built&&!this.disabled&&E.isPlainObject(X)){if(U(X.left)){V.left=X.left}if(U(X.top)){V.top=X.top}if(U(X.width)){V.width=X.width;V.height=X.width/W}else{if(U(X.height)){V.height=X.height;V.width=X.height*W}}this.renderCanvas(true)}},getCropBoxData:function(){var V=this.cropBox,W;if(this.built&&this.cropped){W={left:V.left,top:V.top,width:V.width,height:V.height}}return W||{}},setCropBoxData:function(X){var V=this.cropBox,W=this.options.aspectRatio;if(this.built&&this.cropped&&!this.disabled&&E.isPlainObject(X)){if(U(X.left)){V.left=X.left}if(U(X.top)){V.top=X.top}if(U(X.width)){V.width=X.width}if(U(X.height)){V.height=X.height}if(W){if(U(X.width)){V.height=V.width/W}else{if(U(X.height)){V.width=V.height*W}}}this.renderCropBox()}},getCroppedCanvas:function(ag){var W,aa,Y,ac,ab,ad,af,ae,X,V,Z;if(!this.built||!this.cropped||!c){return}if(!E.isPlainObject(ag)){ag={}}Z=this.getData();W=Z.width;aa=Z.height;ae=W/aa;if(E.isPlainObject(ag)){ab=ag.width;ad=ag.height;if(ab){ad=ab/ae;af=ab/W}else{if(ad){ab=ad*ae;af=ad/aa}}}Y=ab||W;ac=ad||aa;X=E("<canvas>")[0];X.width=Y;X.height=ac;V=X.getContext("2d");if(ag.fillColor){V.fillStyle=ag.fillColor;V.fillRect(0,0,Y,ac)}V.drawImage.apply(V,(function(){var ah=F(this.$clone[0],this.image),ai=ah.width,aj=ah.height,an=[ah],am=Z.x,al=Z.y,ak,at,aq,ap,ar,ao;if(am<=-W||am>ai){am=ak=aq=ar=0}else{if(am<=0){aq=-am;am=0;ak=ar=T(ai,W+am)}else{if(am<=ai){aq=0;ak=ar=T(W,ai-am)}}}if(ak<=0||al<=-aa||al>aj){al=at=ap=ao=0}else{if(al<=0){ap=-al;al=0;at=ao=T(aj,aa+al)}else{if(al<=aj){ap=0;at=ao=T(aa,aj-al)}}}an.push(am,al,ak,at);if(af){aq*=af;ap*=af;ar*=af;ao*=af}if(ar>0&&ao>0){an.push(aq,ap,ar,ao)}return an}).call(this));return X},setAspectRatio:function(W){var V=this.options;if(!this.disabled&&!q(W)){V.aspectRatio=O(W)||NaN;if(this.built){this.initCropBox();if(this.cropped){this.renderCropBox()}}}},setDragMode:function(Y){var W=this.$dragBox,V=false,X=false;if(!this.ready||this.disabled){return}switch(Y){case"crop":if(this.options.dragCrop){V=true;W.data("drag",Y)}else{X=true}break;case"move":X=true;W.data("drag",Y);break;default:W.removeData("drag")}W.toggleClass(J,V).toggleClass(e,X)}});r.change=function(){var ac=this.dragType,Y=this.options,X=this.canvas,ae=this.container,V=this.cropBox,ak=V.width,ah=V.height,Z=V.left,ag=V.top,an=Z+ak,ab=ag+ah,ai=0,ad=0,am=ae.width,aj=ae.height,al=true,W=Y.aspectRatio,af={x:this.endX-this.startX,y:this.endY-this.startY},aa;if(Y.strict){ai=V.minLeft;ad=V.minTop;am=ai+T(ae.width,X.width);aj=ad+T(ae.height,X.height)}if(W){af.X=af.y*W;af.Y=af.x/W}switch(ac){case"all":Z+=af.x;ag+=af.y;break;case"e":if(af.x>=0&&(an>=am||W&&(ag<=ad||ab>=aj))){al=false;break}ak+=af.x;if(W){ah=ak/W;ag-=af.Y/2}if(ak<0){ac="w";ak=0}break;case"n":if(af.y<=0&&(ag<=ad||W&&(Z<=ai||an>=am))){al=false;break}ah-=af.y;ag+=af.y;if(W){ak=ah*W;Z+=af.X/2}if(ah<0){ac="s";ah=0}break;case"w":if(af.x<=0&&(Z<=ai||W&&(ag<=ad||ab>=aj))){al=false;break}ak-=af.x;Z+=af.x;if(W){ah=ak/W;ag+=af.Y/2}if(ak<0){ac="e";ak=0}break;case"s":if(af.y>=0&&(ab>=aj||W&&(Z<=ai||an>=am))){al=false;break}ah+=af.y;if(W){ak=ah*W;Z-=af.X/2}if(ah<0){ac="n";ah=0}break;case"ne":if(W){if(af.y<=0&&(ag<=ad||an>=am)){al=false;break}ah-=af.y;ag+=af.y;ak=ah*W}else{if(af.x>=0){if(an<am){ak+=af.x}else{if(af.y<=0&&ag<=ad){al=false}}}else{ak+=af.x}if(af.y<=0){if(ag>ad){ah-=af.y;ag+=af.y}}else{ah-=af.y;ag+=af.y}}if(ak<0&&ah<0){ac="sw";ah=0;ak=0}else{if(ak<0){ac="nw";ak=0}else{if(ah<0){ac="se";ah=0}}}break;case"nw":if(W){if(af.y<=0&&(ag<=ad||Z<=ai)){al=false;break}ah-=af.y;ag+=af.y;ak=ah*W;Z+=af.X}else{if(af.x<=0){if(Z>ai){ak-=af.x;Z+=af.x}else{if(af.y<=0&&ag<=ad){al=false}}}else{ak-=af.x;Z+=af.x}if(af.y<=0){if(ag>ad){ah-=af.y;ag+=af.y}}else{ah-=af.y;ag+=af.y}}if(ak<0&&ah<0){ac="se";ah=0;ak=0}else{if(ak<0){ac="ne";ak=0}else{if(ah<0){ac="sw";ah=0}}}break;case"sw":if(W){if(af.x<=0&&(Z<=ai||ab>=aj)){al=false;break}ak-=af.x;Z+=af.x;ah=ak/W}else{if(af.x<=0){if(Z>ai){ak-=af.x;Z+=af.x}else{if(af.y>=0&&ab>=aj){al=false}}}else{ak-=af.x;Z+=af.x}if(af.y>=0){if(ab<aj){ah+=af.y}}else{ah+=af.y}}if(ak<0&&ah<0){ac="ne";ah=0;ak=0}else{if(ak<0){ac="se";ak=0}else{if(ah<0){ac="nw";ah=0}}}break;case"se":if(W){if(af.x>=0&&(an>=am||ab>=aj)){al=false;break}ak+=af.x;ah=ak/W}else{if(af.x>=0){if(an<am){ak+=af.x}else{if(af.y>=0&&ab>=aj){al=false}}}else{ak+=af.x}if(af.y>=0){if(ab<aj){ah+=af.y}}else{ah+=af.y}}if(ak<0&&ah<0){ac="nw";ah=0;ak=0}else{if(ak<0){ac="sw";ak=0}else{if(ah<0){ac="ne";ah=0}}}break;case"move":X.left+=af.x;X.top+=af.y;this.renderCanvas(true);al=false;break;case"zoom":this.zoom(function(ap,ar,ao,aq){var au=G(ap*ap+ar*ar),at=G(ao*ao+aq*aq);return(at-au)/au}(y(this.startX-this.startX2),y(this.startY-this.startY2),y(this.endX-this.endX2),y(this.endY-this.endY2)));this.startX2=this.endX2;this.startY2=this.endY2;al=false;break;case"crop":if(af.x&&af.y){aa=this.$cropper.offset();Z=this.startX-aa.left;ag=this.startY-aa.top;ak=V.minWidth;ah=V.minHeight;if(af.x>0){if(af.y>0){ac="se"}else{ac="ne";ag-=ah}}else{if(af.y>0){ac="sw";Z-=ak}else{ac="nw";Z-=ak;ag-=ah}}if(!this.cropped){this.cropped=true;this.$cropBox.removeClass(I)}}break}if(al){V.width=ak;V.height=ah;V.left=Z;V.top=ag;this.dragType=ac;this.renderCropBox()}this.startX=this.endX;this.startY=this.endY};E.extend(x.prototype,r);x.DEFAULTS={aspectRatio:NaN,autoCropArea:0.8,crop:null,data:null,preview:"",strict:true,responsive:true,checkImageOrigin:true,modal:true,guides:true,highlight:true,background:true,autoCrop:true,dragCrop:true,movable:true,resizable:true,rotatable:true,zoomable:true,touchDragZoom:true,mouseWheelZoom:true,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,dragstart:null,dragmove:null,dragend:null,zoomin:null,zoomout:null};x.setDefaults=function(V){E.extend(x.DEFAULTS,V)};x.TEMPLATE=(function(V,W){W=W.split(",");return V.replace(/\d+/g,function(X){return W[X]})})('<0 6="5-container"><0 6="5-canvas"></0><0 6="5-2-9" 3-2="move"></0><0 6="5-crop-9"><1 6="5-view-9"></1><1 6="5-8 8-h"></1><1 6="5-8 8-v"></1><1 6="5-face" 3-2="all"></1><1 6="5-7 7-e" 3-2="e"></1><1 6="5-7 7-n" 3-2="n"></1><1 6="5-7 7-w" 3-2="w"></1><1 6="5-7 7-s" 3-2="s"></1><1 6="5-4 4-e" 3-2="e"></1><1 6="5-4 4-n" 3-2="n"></1><1 6="5-4 4-w" 3-2="w"></1><1 6="5-4 4-s" 3-2="s"></1><1 6="5-4 4-ne" 3-2="ne"></1><1 6="5-4 4-nw" 3-2="nw"></1><1 6="5-4 4-sw" 3-2="sw"></1><1 6="5-4 4-se" 3-2="se"></1></0></0>',"div,span,drag,data,point,cropper,class,line,dashed,box");x.other=E.fn.cropper;E.fn.cropper=function(X){var W=u(arguments,1),V;this.each(function(){var aa=E(this),Z=aa.data("cropper"),Y;if(!Z){aa.data("cropper",(Z=new x(this,X)))}if(typeof X==="string"&&E.isFunction((Y=Z[X]))){V=Y.apply(Z,W)}});return q(V)?this:V};E.fn.cropper.Constructor=x;E.fn.cropper.setDefaults=x.setDefaults;E.fn.cropper.noConflict=function(){E.fn.cropper=x.other;return this}});$(function(){var a=window.console||{log:function(){}},c=$(".docs-alert"),b=c.find(".message"),d=function(f,e){b.text(f);if(e){b.addClass(e)}c.fadeIn();setTimeout(function(){c.fadeOut()},3000)};(function(){var f=$(".img-container > img"),k=$("#dataX"),i=$("#dataY"),h=$("#dataHeight"),e=$("#dataWidth"),m=$("#dataRotate"),n={aspectRatio:16/9,preview:".img-preview",crop:function(o){k.val(Math.round(o.x));i.val(Math.round(o.y));h.val(Math.round(o.height));e.val(Math.round(o.width));m.val(Math.round(o.rotate))}};f.on({"build.cropper":function(o){a.log(o.type)},"built.cropper":function(o){a.log(o.type)},"dragstart.cropper":function(o){a.log(o.type,o.dragType)},"dragmove.cropper":function(o){a.log(o.type,o.dragType)},"dragend.cropper":function(o){a.log(o.type,o.dragType)},"zoomin.cropper":function(o){a.log(o.type)},"zoomout.cropper":function(o){a.log(o.type)}}).cropper(n);$(document.body).on("click","[data-method]",function(){var q=$(this).data(),p,o;if(q.method){q=$.extend({},q);if(typeof q.target!=="undefined"){p=$(q.target);if(typeof q.option==="undefined"){try{q.option=JSON.parse(p.val())}catch(r){a.log(r.message)}}}o=f.cropper(q.method,q.option);if(q.method==="getCroppedCanvas"){$("#getCroppedCanvasModal").modal().find(".modal-body").html(o)}if($.isPlainObject(o)&&p){try{p.val(JSON.stringify(o))}catch(r){a.log(r.message)}}}}).on("keydown",function(o){switch(o.which){case 37:o.preventDefault();f.cropper("move",-1,0);break;case 38:o.preventDefault();f.cropper("move",0,-1);break;case 39:o.preventDefault();f.cropper("move",1,0);break;case 40:o.preventDefault();f.cropper("move",0,1);break}});var g=$("#inputImage"),l=window.URL||window.webkitURL,j;if(l){g.change(function(){var p=this.files,o;if(p&&p.length){o=p[0];if(/^image\/\w+$/.test(o.type)){j=l.createObjectURL(o);f.one("built.cropper",function(){l.revokeObjectURL(j)}).cropper("reset").cropper("replace",j);g.val("")}else{d("Please choose an image file.")}}})}else{g.parent().remove()}$(".docs-options :checkbox").on("change",function(){var o=$(this);n[o.val()]=o.prop("checked");f.cropper("destroy").cropper(n)});$('[data-toggle="tooltip"]').tooltip()}())});