<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core" 
    xmlns:p="http://primefaces.org/ui"
    xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
    >

    <h:head>
        <!-- STANDARD CONFIG -->
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta http-equiv="refresh" 
              content="60;url=#{request.contextPath}#{request.servletPath}/logout.xhtml?faces-redirect=true"/>

        <!-- ISM TITLE PAGE -->
        <title>#{ism.AppName}</title>

        <!-- ISM LOGO -->
        <link rel="shortcut icon" href="#{resource['img/ism/favico.png']}" type="image/x-png" /> 


        <f:facet name="last">
            <!-- CSS - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- CSS - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- CSS - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- CSS - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- Font-Awesome -->
            <h:outputStylesheet library="webjars" name="font-awesome/4.7.0/css/font-awesome.min-jsf.css"/>

            <!-- Bootstrap -->
            <h:outputStylesheet library="webjars" name="cropper/3.1.3/dist/cropper.min.css" />
            <h:outputStylesheet library="webjars" name="bootstrap/4.0.0-beta.2/css/bootstrap.min-jsf.css" />

            <!-- ISM -->
            <h:outputStylesheet library="css" name="ism-login.min.css" />
            <!--
            <h:outputStylesheet library="css" name="ism.min.css" />
            -->
            <!-- JS  - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- JS  - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- JS  - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- JS  - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

            <!-- PRIMEFACES  -->
            <h:outputScript library="primefaces" name="jquery/jquery.js" target="head" />

            <!-- JQUERY UI : NECESSAIRE POUR L'USAGE DE DATRERANGE PICKER -->
            <h:outputScript library="vendor" name="jquery-ui/1.12.1/jquery-ui.min.js" target="head" />

            <!-- Bootstrap -->
            <h:outputScript library="webjars" name="popper.js/1.12.9/dist/umd/popper.min.js" />
            <h:outputScript library="webjars" name="bootstrap/4.0.0-beta.2/js/bootstrap.bundle.min.js" />
        </f:facet>
    </h:head>



    <h:body id="body" style="background-color: rgba(41, 43, 44, 0.07)!important;" >



        <!-- Content -->
        <div class="container-fluid " >
            <div class="area-bg" style="height: 100vh;">
                <div class="area-content">


                    <div class="justify-content-center">
                        <!-- *********************************************** -->
                        <!-- Insertion de l'image de l'application au centre -->
                        <!-- *********************************************** -->
                        <div class="row ">
                            <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12 align-self-center" >
                                <center style="background-color: rgba(41, 43, 44, 0.07)!important;">
                                    <h:graphicImage value="#{resource['img/ism/ism.png']}"  
                                                    width="96px" height="96px"
                                                    />
                                    <div style="padding: 10px;">#{ism.AppName} - #{ism.AppVersion}</div>
                                </center>
                            </div>
                        </div>

                        <!-- *********************************************** -->
                        <!-- Insertion d'un message d'acceuil                -->
                        <!-- *********************************************** -->
                        <div class="row py-2">
                            <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12">
                                <center><div id="welcome">#{ism.Welcome}</div></center>
                            </div>
                        </div>

                    </div>
                    <!-- *********************************************** -->
                    <!-- Création de la zone centrale de contenu login   -->
                    <!-- *********************************************** -->
                    <div class="row py-4">
                        <div class="col-sm-4"></div>
                        <div class="col-sm-4 ">
                            <center>
                                <div class="card " style="max-width: 367px;">

                                    <!-- *********************************************** -->
                                    <!-- Card Header : Invitation de connexion           -->
                                    <!-- *********************************************** -->
                                    <div class="card-header">
                                        <div class="d-flex justify-content-center">
                                            <img src="#{resource['img/ism/hr/img_avatar4.png']}" 
                                                 alt="Avatar" width="96" height="96" class="rounded-circle" />
                                        </div>
                                        <div class="d-flex justify-content-center small">Entrer vos informations de connexion</div>
                                    </div>

                                    <!-- *********************************************** -->
                                    <!-- Card Body : Corp de connexion           -->
                                    <!-- *********************************************** -->
                                    <div class="card-body p-3">
                                        <h:form id="logForm" >

                                            <div class="input-group input-group-sm mb-2 " data-toggle="tooltip" data-placement="left" title="#{ism.AuthenticationFieldInfo_staff}">
                                                <div class="input-group-addon">
                                                    <span class="fa fa-user form-control-feedback"></span>
                                                </div>
                                                <p:inputText id="j_username" 
                                                             type="text"
                                                             value="#{staffAuthController.staff.stStaff}"
                                                             required="true"
                                                             a:autocorrect="off" 
                                                             autocomplete="off"
                                                             label="#{ism.Login}"
                                                             placeholder="#{ism.Login}"
                                                             class="form-control"
                                                             />
                                            </div>

                                            <div class="input-group input-group-sm mb-2" data-toggle="tooltip" data-placement="left" title="#{ism.AuthenticationFieldInfo_password}" >
                                                <div class="input-group-addon">
                                                    <span class="fa fa-lock form-control-feedback"></span>
                                                </div>
                                                <p:password id="j_password"
                                                            value="#{staffAuthController.staff.stPassword}"
                                                            required="true"
                                                            autocomplete="off"    
                                                            label="#{ism.Password}"
                                                            placeholder="#{ism.Password}"
                                                            class="form-control"
                                                            />
                                            </div>

                                            <div class="input-group input-group-sm small p-0 mb-2" data-toggle="tooltip" data-placement="left" title="#{ism.AuthenticationFieldInfo_company}">
                                                <p:selectOneMenu id="company"
                                                                 class="form-control m-0 p-0"
                                                                 style="width:100%"
                                                                 value="#{staffAuthController.company}" converter="#{companyConverter}"
                                                                 >
                                                    <f:selectItems value="#{companyController.itemsAvailableSelectOne}" 
                                                                   var="jCompanyItem"
                                                                   itemLabel="#{jCompanyItem.CCompany} - #{jCompanyItem.CDesignation}"
                                                                   itemValue="#{jCompanyItem}"
                                                                   class="small m-0 p-0"
                                                                   />
                                                </p:selectOneMenu>
                                            </div>

                                            <div class="input-group mt-3 small">
                                                <div class="checkbox">
                                                    <label>
                                                        <input id="rememberMe" type="checkbox" name="remember" value="1" onclick="PF('dlgAuthentication').show();"/> Mémoriser
                                                    </label>
                                                </div>
                                            </div>


                                            <p:commandButton id="btnLogIn"
                                                             type="submit"
                                                             value="#{ism.LogIn}"
                                                             action="#{staffAuthController.login}"
                                                             update=":growl"
                                                             class="btn btn-primary bg-primary"
                                                             icon="fa fa-sign-in "
                                                             style="width: 100%"
                                                             />

                                            <hr />

                                            <div class="small text-left">
                                                <label class="small smallTxt">Mot de passe oublié ! <p:link  value="Réinitialiser..." href="#" onclick="PF('dlgAuthentication').show();"/></label><br />
                                                <label class="small smallTxt">Aucun compte !  <p:link value="Demander..." href="#" onclick="PF('dlgAuthentication').show();"/></label>
                                            </div>

                                        </h:form>
                                    </div>
                                </div><!-- Hend card -->
                            </center>
                        </div>

                        <div class="col-sm-4"></div>
                    </div>
                </div>
            </div>

        </div>


        <p:growl id="growl" life="8000" />
    </h:body>






    <!-- Permet d'informer l'utilisateur lors d'usage de fonction non définie -->
    <p:dialog header="Autorisation..." widgetVar="dlgAuthentication" minHeight="60" resizable="false">
        <f:facet name="footer">
            <div class="d-flex flex-row-reverse ">
                <p:commandButton value="Fermer" class="btn btn-primary bg-primary text-light" type="button" 
                                 onclick="PF('dlgAuthentication').hide()"
                                 icon="fa fa-close" style="width: 100%;" />
            </div>
        </f:facet>
        <h:outputText class="small" value="Vous n'êtes pas autorisé à utiliser cette fonction !" />
    </p:dialog>

    <!-- Permet d'afficher une feuille de chargement lors de commande ajax -->
    <p:blockUI block="body" trigger="logForm:btnLogIn">
        <p:graphicImage width="120px" height="120px" library="img" name="ism/std/Onload.gif"/>
    </p:blockUI>

    <script>
        // Redirect user to https
        window.onload = function () {
            if (window.location.href.indexOf('http://') === 0)
                window.location = 'https://' + window.location.hostname + ':8181' + window.location.pathname + window.location.search;
        };
        $(function () {
            $('[data-toggle="tooltip"]').tooltip();
        })
    </script>

</html>



